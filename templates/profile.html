{% extends 'base.html' %}

{% block Title %} Profile {% endblock %}

{% block head %} 
<script type="text/javascript" src="../static/facebook_login.js"></script>
<link rel="stylesheet" rel="text/css" href="../static/navbar.css">
<link rel="stylesheet" rel="text/css" href="../static/profile.css">

{% endblock %}

{% block content %}
<div class="container">
    <div class="row well">
        <h1>Welcome, {{ user.first_name }}</h1>
        <h4>See below for your ride information</h4>
    </div>

{% if rides_offered_requests %}

    <table class="table table-hover">
    <h2>Approve/Deny Ride Requests</h2>
    <thead>
      <tr>
        <th>Date</th>
        <th>From</th>
        <th>Time</th>
        <th>To</th>
        <th>Time</th>
        <th>Cost</th>
        <th>Requester</th>
        <th>Seats Requested</th>
        <th>Approve/Deny</th>
      </tr>
    </thead>
    <tbody>
{% for ride in rides_offered_requests %}

{% for request in ride.requests %}
      <tr>
        <td>{{ ride.start_timestamp.strftime('%Y-%m-%d') }}</td>
        <td>{{ ride.start_city }}, {{ ride.start_state }}</td>
        <td>{{ ride.start_timestamp.strftime('%H:%M') }}</td>
        <td>{{ ride.end_city }}, {{ ride.end_state }}</td>
        <td>hi</td>
        <td>{{ ride.cost }}</td>
        <td>{{ request.user.first_name }} {{ request.user.last_name }}</td>
        <td>{{ request.seats }}</td>
        <td>
            <form action="/request-approval" method="POST">
                <input type="hidden" name="request_id" value={{ request.id }}></input>
                <input type="hidden" name="ride_id" value={{ ride.ride_id }}></input>
                <input type="hidden" name="requester" value={{ request.requester }}></input>
                <input type="hidden" name="seats" value={{ request.seats }}></input>
                <input type="submit" name='approvedeny' value="Approve">
            </form>
            <form action="/request-approval" method="POST">
                <input type="hidden" name="request_id" value={{request.id}}></input>
                <input type="submit" name='approvedeny' value="Reject">
            </form>
        </td>
      </tr>
{% endfor %}
{% endfor %}
    </tbody>
  </table>

{% endif %}


{% if rides_taking_requests %}

    <table class="table table-hover">
    <h2>Requested Rides - pending</h2>
    <thead>
      <tr>
        <th>Date</th>
        <th>From</th>
        <th>Time</th>
        <th>To</th>
        <th>Time</th>
        <th>Cost</th>
        <th>Driver</th>
        <th>Seats Requested</th>
      </tr>
    </thead>
    <tbody>
{% for request in rides_taking_requests %}

      <tr>
        <td>{{ request.ride.start_timestamp.strftime('%Y-%m-%d') }}</td>
        <td>{{ request.ride.start_city }}, {{ request.ride.start_state }}</td>
        <td>{{ request.ride.start_timestamp.strftime('%H:%M') }}</td>
        <td>{{ request.ride.end_city }}, {{ request.ride.end_state }}</td>
        <td></td>
        <td>{{ request.ride.cost }}</td>
        <td>{{ request.ride.user.first_name }}</td>
        <td>{{ request.seats }}</td>
      </tr>
{% endfor %}
    </tbody>
  </table>

{% endif %}


{% if rides_offered %}

<div class="container">
    <table class="table table-hover">
    <h2>Upcoming Rides you have offered</h2>
    <thead>
      <tr>
        <th>Date</th>
        <th>From</th>
        <th>Time</th>
        <th>To</th>
        <th>Time</th>
        <th>Seats</th>
        <th>Cost</th>
      </tr>
    </thead>
    <tbody>
    {% for ride in rides_offered %}
      <tr>
        <td>{{ ride.start_timestamp.strftime('%Y-%m-%d') }}</td>
        <td>{{ ride.start_city }}, {{ ride.start_state }}</td>
        <td>{{ ride.start_timestamp.strftime('%H:%M')}}</td>
        <td>{{ ride.end_city }}, {{ ride.end_state }}</td>
        <td>hi</td>
        <td>{{ ride.seats }}</td>
        <td>{{ ride.cost }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

{% endif %}


{% if rides_taking %}

<div class="container">
    <table class="table table-hover">
    <h2>Upcoming Rides you are taking</h2>
    <thead>
      <tr>
        <th>Date</th>
        <th>Driver</th>
        <th>From</th>
        <th>Time</th>
        <th>To</th>
        <th>Time</th>
        <th>Seats</th>
        <th>Cost</th>
      </tr>
    </thead>
    <tbody>
    {% for ride in rides_taking %}
      <tr>
        <td>{{ ride.ride.start_timestamp.strftime('%Y-%m-%d') }}</td>
        <td>{{ ride.ride.user.first_name }} {{ ride.ride.user.last_name }}</td>
        <td>{{ ride.ride.start_city }}, {{ ride.ride.start_state }}</td>
        <td>{{ ride.ride.start_timestamp.strftime('%H:%M')}}</td>
        <td>{{ ride.ride.end_city }}, {{ ride.ride.end_state }}</td>
        <td>hi</td>
        <td>{{ ride.ride.seats }}</td>
        <td>{{ ride.ride.cost }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

{% endif %}



{% endblock %}